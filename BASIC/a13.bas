10 PRINT "A13 EIGENSOLUTIONS OF A SYMMETRIC MATRIX VIA SVD"
20 LET N9=20
30 DIM A(N9,N9),V(N9,N9),B(N9,N9),D(N9),Z(N9)
40 PRINT "ORDER OF MATRIX: ";
50 READ N
55 PRINT N
60 IF (N <= 0) THEN QUIT
70 LET M=N
80 GOSUB 1500: REM BUILD FRANK MATRIX N BY N
100 GOSUB 3000
110 FOR I=1 TO N
120   PRINT "EV(";I;")=";D(I);"    RQ=";Z(I)
130   FOR J=1 TO N
140      PRINT V(J,I);" ";
150   NEXT J
155   PRINT
160 NEXT I
170 PRINT
200 GOTO 40
300 DATA  2, 4, 10, 1, 0
1500 REM PREPARE FRANK MATRIX IN A
1510 FOR I=1 TO M
1530 FOR J=1 TO N
1540 IF (I <= J) THEN LET A(I,J)=I ELSE LET A(I,J)=J
1545 LET B(I,J)=A(I,J)
1550 NEXT J
1560 NEXT I
1570 RETURN
3000 PRINT "SMEV.NJ ALG 13 DEC 7 78"
3002 LET E1=1E-7
3004 IF (N > 1) THEN GOTO 3020
3006 LET D(1)=A(1,1)
3008 LET V(1,1)=1
3010 LET Z(1)=D(1)
3012 RETURN
3014 REM END SPECIAL CASE N=1
3018 REM DIM A(N,N),V(N,N),B(N,N) (FOR RAYLEIGH QUOTIENT)
3020 LET H=1E+38: REM BIG NUMBER
3025 FOR I=1 TO N
3030   LET V1=A(I,I)
3035   FOR J=1 TO N
3040     LET B(I,J)=A(I,J)
3045     IF I=J THEN GOTO 3055
3050     LET V1=V1-ABS(A(I,J))
3055   NEXT J
3060   IF V1>=H THEN GOTO 3070
3065   LET H=V1
3070 NEXT I
3075 IF H<E1 THEN GOTO 3090
3080 LET H=0
3085 GOTO 3120
3090 LET H=H-SQR(E1)
3095 FOR I=1 TO N
3100   LET A(I,I)=A(I,I)-H
3105 NEXT I
3110 PRINT 
3115 PRINT "SCALING BY SUBTRACTION OF",H
3120 LET I9=0
3125 LET N2=N*(N-1)/2
3130 LET N1=N-1
3135 LET N9=N2
3140 LET I9=I9+1
3145 LET N9=0
3150 IF I9<=30 THEN GOTO 3170
3155 PRINT 
3160 PRINT "NON-",
3165 GOTO 3355
3170 FOR J=1 TO N1
3175   LET J1=J+1
3180   FOR K=J1 TO N
3185     LET P=0
3190     LET R=0
3195     LET Q=0
3200     FOR I=1 TO N
3205       LET P=P+A(I,J)*A(I,K)
3210       LET Q=Q+A(I,J)*A(I,J)
3215       LET R=R+A(I,K)*A(I,K)
3220     NEXT I
3225     IF 1+ABS(P/SQR(Q*R))>1 THEN GOTO 3235
3230     IF Q>=R THEN GOTO 3320
3235     LET Q=Q-R
3240     LET V1=SQR(4*P*P+Q*Q)
3245     IF V1=0 THEN GOTO 3320
3250     IF Q<0 THEN GOTO 3270
3255     LET C=SQR((V1+Q)/(2*V1))
3260     LET S=P/(V1*C)
3265     GOTO 3290
3270     LET S=SQR((V1-Q)/(2*V1))
3275     IF P>0 THEN GOTO 3285
3280     LET S=-S
3285     LET C=P/(V1*S)
3290     FOR I=1 TO N
3295       LET V1=A(I,J)
3300       LET A(I,J)=V1*C+A(I,K)*S
3305       LET A(I,K)=-V1*S+A(I,K)*C
3310     NEXT I
3315     GOTO 3325
3320     LET N9=N9+1
3325   NEXT K
3330 NEXT J
3335 IF N9=N2 THEN GOTO 3350
3340 PRINT "SWEEP",I9,"  ",N9,"SMALL P"
3345 GOTO 3140
3350 PRINT 
3355 PRINT "CONVERGENCE AT SWEEP",I9
3360 LET V1=0
3365 LET C=0
3370 FOR J=1 TO N
3375   LET Q=0
3380   FOR I=1 TO N
3385     LET Q=Q+A(I,J)^2
3390   NEXT I
3395   LET Q=SQR(Q)
3400   FOR I=1 TO N
3405     LET V(I,J)=A(I,J)/Q
3410   NEXT I
3415   LET Q=Q+H
3420   GOSUB 3440
3425   LET D(J)=Q
3430 NEXT J
3435 RETURN 
3440 LET Q=0
3445 FOR I=1 TO N
3450   FOR K=1 TO N
3455     LET Q=Q+V(I,J)*B(I,K)*V(K,J)
3460   NEXT K
3465 NEXT I
3470 LET Z(J)=Q
3475 RETURN 
