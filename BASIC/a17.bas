10 PRINT  "DRIVER FOR ALG 17 -- FEB 1980"
20 PRINT "INITIAL VALUE OF VARIABLE B=",
30 INPUT B
40 PRINT "INITIAL STEP LENGTH=",
50 INPUT S9
60 GOSUB 2000
70 PRINT "MINIMUM FOUND AT B=",B,"  FN VALUE=",S1
80 PRINT I9," FN EVALS"
90 STOP
2000 REM ALG 17 FEBRUARY 1980
2010 I9=0\ A1=1.5\ A2=-0.25\ REM STEP 0
2020 I9=I9+1 \ I3=0 \ GOSUB 3000\ REM STEP 1
2030 IF I3>0 THEN STOP \ REM FAILURE CHECK
2040 S1=P \ S0=-1.0E+60 \ X1=0 \ B9=B \ REM STEP 2
2050 X2=X1+S9 \ B=B9+X2 \ REM STEP 3
2060 IF B=B9+X1 THEN RETURN \ REM STEP 4
2070 I9=I9+1 \ I3=0 \ GOSUB 3000 \ REM STEP 5
2080 IF I3>0 THEN 2100
2090 IF P<S1 THEN 2130 \ REM STEP 6
2100 IF S0>=S1 THEN 2150 \ REM STEP 7
2110 S0=P \ X0=X2 \ REM STEP 8 (OPTIONAL)
2120 S9=A2*S9 \ PRINT "FAILURE" \ GOTO 2050 \ REM STEP 9
2130 X0=X1 \ S0=S1 \ X1=X2 \ S1=P \S9=A1*S9 \ REM STEP 10
2140 PRINT "SUCCESS" \ GOTO 2050
2150 X0=X0-X1 \ S0=(S0-S1)*S9 \ P=(P-S1)*X0 \ REM STEP 11
2160 IF P=S0 THEN 2230 \ REM STEP 12
2170 S9=0.5*(P*X0-S0*S9)/(P-S0) \ PRINT "PARAMIN STEP=",S9 \REM STEP 13
2180 X2=X1+S9 \ B=B9+X2 \ REM STEP 14
2190 IF B=B9+X1 THEN GOTO 2250 \ REM STEP 15
2200 I9=I9+1 \ I3=0 \ GOSUB 3000 \ REM STEP 16
2210 IF I3>0 THEN 2230
2220 IF P<S1 THEN 2250 \ PRINT "PARAMIN FAILS" \ REM STEP 17
2230 B=B9+X1 \ P=S1 \ GOTO 2250 \ REM STEP 18
2240 X1=X2 \ STEP 19
2250 S9=A2*S9 \ PRINT "NEW STEP=",S9 \ GOTO 2040 \ REM STEP 20
2260 REM END ALG 17
3000 REM EXAMPLE PG 130
3010 IF B<=200 THEN 3030 \ REM TEST FOR B OUT OF RANGE
3020 I3=1 \ RETURN
3030 P=-250*B+22500*(1.00949^B)
3040 PRINT "F(",B,")=",P
3050 RETURN
